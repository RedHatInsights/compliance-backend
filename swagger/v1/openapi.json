{
  "openapi": "3.0.3",
  "info": {
    "title": "Cloud Services for RHEL Compliance API V1",
    "version": "v1",
    "description": "This is the API for Cloud Services for RHEL Compliance. You can find out more about Red Hat Cloud Services for RHEL at [https://console.redhat.com/](https://console.redhat.com/)"
  },
  "paths": {
    "/api/compliance/benchmarks": {
      "get": {
        "summary": "List all benchmarks",
        "tags": [
          "benchmark"
        ],
        "description": "Lists all benchmarks requested",
        "operationId": "ListBenchmarks",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to return",
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 10
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to skip before starting to collect the result set",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "search",
            "in": "query",
            "required": false,
            "type": "string",
            "description": "Query string compliant with scoped_search query language: https://github.com/wvanbergen/scoped_search/wiki/Query-language",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "required": false,
            "type": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "description": "An array of fields with an optional direction (:asc or :desc) to sort the results.",
            "schema": {
              "type": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "array"
                  }
                ]
              },
              "items": {
                "enum": [
                  "title",
                  "version",
                  "title:asc",
                  "title:desc",
                  "version:asc",
                  "version:desc"
                ]
              },
              "default": ""
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "200": {
            "description": "lists all benchmarks requested",
            "examples": {
              "application/vnd.api+json": {
                "data": [
                  {
                    "id": "10fd70a8-195b-41f8-b395-4f2a69d9c349",
                    "type": "benchmark",
                    "attributes": {
                      "ref_id": "xccdf_org.ssgproject.content_benchmark_RHEL-7",
                      "title": "Animi molestias non quos.",
                      "version": "100.0.1",
                      "description": "Id aut animi. Velit quis voluptatem. Consequatur et quo.",
                      "os_major_version": "7",
                      "latest_supported_os_minor_versions": []
                    },
                    "relationships": {
                      "rules": {
                        "data": [
                          {
                            "id": "dad7efa5-0f6c-4400-bb97-ca1ef208400b",
                            "type": "rule"
                          },
                          {
                            "id": "d8dfee4a-263b-4fb0-b935-959871aae36c",
                            "type": "rule"
                          }
                        ]
                      },
                      "profiles": {
                        "data": [
                          {
                            "id": "9bec64d3-408e-4ca7-8eb4-baedb5746dbf",
                            "type": "profile"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "id": "22cf1524-5850-4b4c-b764-c12f268aa0f5",
                    "type": "benchmark",
                    "attributes": {
                      "ref_id": "xccdf_org.ssgproject.content_benchmark_RHEL-7",
                      "title": "Veniam repellat sint id.",
                      "version": "100.0.2",
                      "description": "Cupiditate harum at. Cupiditate repellendus inventore. Et voluptatum magnam.",
                      "os_major_version": "7",
                      "latest_supported_os_minor_versions": []
                    },
                    "relationships": {
                      "rules": {
                        "data": [
                          {
                            "id": "2af93cb9-dfc0-49cb-bfed-8b2496a114b7",
                            "type": "rule"
                          },
                          {
                            "id": "ea56f75f-4840-4ad3-ad0a-abcfcf08550c",
                            "type": "rule"
                          }
                        ]
                      },
                      "profiles": {
                        "data": [
                          {
                            "id": "ceccda62-adc1-45a4-9d59-e1c79ebff529",
                            "type": "profile"
                          }
                        ]
                      }
                    }
                  }
                ],
                "meta": {
                  "total": 2,
                  "limit": 10,
                  "offset": 1,
                  "relationships": true
                },
                "links": {
                  "first": "/api/compliance/benchmarks?include=&limit=10&offset=1&relationships=true",
                  "last": "/api/compliance/benchmarks?include=&limit=10&offset=1&relationships=true"
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "$ref": "#/components/schemas/uuid"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/benchmark"
                          },
                          "relationships": {
                            "$ref": "#/components/schemas/benchmark_relationships"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/benchmarks/{id}": {
      "get": {
        "summary": "Retrieve a benchmark",
        "tags": [
          "benchmark"
        ],
        "description": "Retrieves data for a benchmark",
        "operationId": "ShowBenchmark",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "404": {
            "description": "benchmark not found",
            "examples": {
              "application/vnd.api+json": {
                "errors": [
                  "Xccdf::Benchmark not found with ID invalid"
                ]
              }
            }
          },
          "200": {
            "description": "retrieves a benchmark",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "7243e139-28cd-4350-b09a-83cd858f5c35",
                  "type": "benchmark",
                  "attributes": {
                    "ref_id": "xccdf_org.ssgproject.content_benchmark_RHEL-7",
                    "title": "Nesciunt sint ea ut.",
                    "version": "100.0.4",
                    "description": "Reprehenderit maiores tenetur. Et quo est. Facere doloribus amet.",
                    "os_major_version": "7",
                    "latest_supported_os_minor_versions": []
                  },
                  "relationships": {
                    "rules": {
                      "data": [
                        {
                          "id": "bffc2d7d-b4e8-48ee-98b7-2a9d8b296fd0",
                          "type": "rule"
                        },
                        {
                          "id": "36d16dc8-9a6d-4347-8b8a-78e426b7d19c",
                          "type": "rule"
                        },
                        {
                          "id": "e8577292-7880-4aab-b156-fd4ed73570f3",
                          "type": "rule"
                        },
                        {
                          "id": "36b3b64e-46e2-412e-8e45-b2cd8334313d",
                          "type": "rule"
                        },
                        {
                          "id": "f8c361c9-4594-43d7-872a-7b06df652704",
                          "type": "rule"
                        },
                        {
                          "id": "03d37de4-e31c-4258-8348-9af0a7d7dc14",
                          "type": "rule"
                        },
                        {
                          "id": "bcd2f28a-aee8-4073-aa72-c8b15547d86d",
                          "type": "rule"
                        },
                        {
                          "id": "9af72d31-2f97-46eb-84bf-daa3f5367849",
                          "type": "rule"
                        },
                        {
                          "id": "7dc9b13c-5e2b-4f8d-bb18-c13b11a70897",
                          "type": "rule"
                        },
                        {
                          "id": "a7c8e5f6-2347-4be6-9ea8-efc1625dde87",
                          "type": "rule"
                        }
                      ]
                    },
                    "profiles": {
                      "data": [
                        {
                          "id": "6b628122-0101-4b88-b07d-a9d7079224d8",
                          "type": "profile"
                        },
                        {
                          "id": "8b322f03-8cba-4afb-969e-db0bbc5c5699",
                          "type": "profile"
                        }
                      ]
                    }
                  }
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/benchmark"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/benchmark_relationships"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/business_objectives": {
      "get": {
        "summary": "List all business_objectives",
        "tags": [
          "business_objective"
        ],
        "description": "Lists all business_objectives requested",
        "operationId": "ListBusinessObjectives",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to return",
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 10
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to skip before starting to collect the result set",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "search",
            "in": "query",
            "required": false,
            "type": "string",
            "description": "Query string compliant with scoped_search query language: https://github.com/wvanbergen/scoped_search/wiki/Query-language",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "required": false,
            "type": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "description": "An array of fields with an optional direction (:asc or :desc) to sort the results.",
            "schema": {
              "type": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "array"
                  }
                ]
              },
              "items": {
                "enum": [
                  "title",
                  "title:asc",
                  "title:desc"
                ]
              },
              "default": ""
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "200": {
            "description": "lists all business_objectives requested",
            "examples": {
              "application/vnd.api+json": {
                "data": [
                  {
                    "id": "07e5d7f3-ca5e-401d-af51-7283beed34b6",
                    "type": "business_objective",
                    "attributes": {
                      "title": "Adipisci provident sunt ullam."
                    },
                    "relationships": {
                      "profiles": {
                        "data": [
                          {
                            "id": "e769405e-f2bf-4cb6-8faf-125ebf1f705b",
                            "type": "profile"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "id": "703c243b-d2b0-41ba-bd4a-5e7edc5f96a3",
                    "type": "business_objective",
                    "attributes": {
                      "title": "Rerum vitae fugiat sed."
                    },
                    "relationships": {
                      "profiles": {
                        "data": [
                          {
                            "id": "7db5215d-d14e-44bb-831d-c1b1c7aac689",
                            "type": "profile"
                          }
                        ]
                      }
                    }
                  }
                ],
                "meta": {
                  "total": 2,
                  "limit": 10,
                  "offset": 1,
                  "sort_by": "title",
                  "relationships": true
                },
                "links": {
                  "first": "/api/compliance/business_objectives?include=&limit=10&offset=1&relationships=true&sort_by=title",
                  "last": "/api/compliance/business_objectives?include=&limit=10&offset=1&relationships=true&sort_by=title"
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "$ref": "#/components/schemas/uuid"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/business_objective"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/business_objectives/{id}": {
      "get": {
        "summary": "Retrieve a business_objective",
        "tags": [
          "business_objective"
        ],
        "description": "Retrieves data for a business_objective",
        "operationId": "ShowBusinessObjective",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "404": {
            "description": "business_objective not found",
            "examples": {
              "application/vnd.api+json": {
                "errors": [
                  "BusinessObjective not found with ID invalid"
                ]
              }
            }
          },
          "200": {
            "description": "retrieves a business_objective",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "bf2b0ff0-24f2-43c4-827f-ae341fdf5c90",
                  "type": "business_objective",
                  "attributes": {
                    "title": "Rerum ut officiis accusamus."
                  },
                  "relationships": {
                    "profiles": {
                      "data": [
                        {
                          "id": "ba7fe75f-b42c-4691-aa9e-0fdd1672d9ed",
                          "type": "profile"
                        }
                      ]
                    }
                  }
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/business_objective"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/business_objective_relationships"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/profiles": {
      "get": {
        "summary": "List all profiles",
        "tags": [
          "profile"
        ],
        "description": "Lists all profiles requested",
        "operationId": "ListProfiles",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to return",
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 10
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to skip before starting to collect the result set",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "search",
            "in": "query",
            "required": false,
            "type": "string",
            "description": "Query string compliant with scoped_search query language: https://github.com/wvanbergen/scoped_search/wiki/Query-language",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "required": false,
            "type": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "description": "An array of fields with an optional direction (:asc or :desc) to sort the results.",
            "schema": {
              "type": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "array"
                  }
                ]
              },
              "items": {
                "enum": [
                  "name",
                  "os_minor_version",
                  "score",
                  "name:asc",
                  "name:desc",
                  "os_minor_version:asc",
                  "os_minor_version:desc",
                  "score:asc",
                  "score:desc"
                ]
              },
              "default": ""
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "200": {
            "description": "lists all profiles requested filtered by OS",
            "examples": {
              "application/vnd.api+json": {
                "data": [
                  {
                    "id": "afdaf2b9-5b43-4fdd-85a1-4ccc87f4fad1",
                    "type": "profile",
                    "attributes": {
                      "ref_id": "xccdf_org.ssgproject.content_profile_45d4236e-2323-4a3b-8a0b-39541e9e048e",
                      "score": 0.42,
                      "parent_profile_id": null,
                      "external": false,
                      "compliance_threshold": 100.0,
                      "os_major_version": "7",
                      "os_version": "7",
                      "policy_profile_id": null,
                      "os_minor_version": "",
                      "parent_profile_ref_id": null,
                      "name": "Canonical Profile",
                      "description": "Canonical (Generated) Profile",
                      "canonical": true,
                      "tailored": false,
                      "total_host_count": 0,
                      "ssg_version": "100.0.13",
                      "compliant_host_count": 0,
                      "test_result_host_count": 0,
                      "unsupported_host_count": 0,
                      "business_objective": null,
                      "policy_type": "Canonical Profile"
                    },
                    "relationships": {
                      "account": {
                        "data": null
                      },
                      "benchmark": {
                        "data": {
                          "id": "b7f11391-f68e-46c6-a66f-66b98f5180d8",
                          "type": "benchmark"
                        }
                      },
                      "parent_profile": {
                        "data": null
                      },
                      "rules": {
                        "data": []
                      },
                      "hosts": {
                        "data": [
                          {
                            "id": "53c5f159-4cbe-40c4-bc78-206b2092cea9",
                            "type": "host"
                          }
                        ]
                      },
                      "test_results": {
                        "data": [
                          {
                            "id": "f666ea5e-5f78-4af5-a300-a7cde9a7d946",
                            "type": "test_result"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "id": "3c41e339-611d-455d-ba43-16c08e5aabf3",
                    "type": "profile",
                    "attributes": {
                      "ref_id": "xccdf_org.ssgproject.content_profile_c06f9bdf-3173-4c61-a950-b8564ff28803",
                      "score": 0.68,
                      "parent_profile_id": null,
                      "external": false,
                      "compliance_threshold": 100.0,
                      "os_major_version": "7",
                      "os_version": "7",
                      "policy_profile_id": null,
                      "os_minor_version": "",
                      "parent_profile_ref_id": null,
                      "name": "Sit nihil magni unde.",
                      "description": "Aut inventore ad. Distinctio voluptatibus maxime. Voluptas natus non.",
                      "canonical": true,
                      "tailored": false,
                      "total_host_count": 0,
                      "ssg_version": "100.0.14",
                      "compliant_host_count": 0,
                      "test_result_host_count": 0,
                      "unsupported_host_count": 0,
                      "business_objective": null,
                      "policy_type": "Sit nihil magni unde."
                    },
                    "relationships": {
                      "account": {
                        "data": null
                      },
                      "benchmark": {
                        "data": {
                          "id": "171d937a-9821-4b3a-acb8-ad9589c781f4",
                          "type": "benchmark"
                        }
                      },
                      "parent_profile": {
                        "data": null
                      },
                      "rules": {
                        "data": []
                      },
                      "hosts": {
                        "data": [
                          {
                            "id": "53c5f159-4cbe-40c4-bc78-206b2092cea9",
                            "type": "host"
                          }
                        ]
                      },
                      "test_results": {
                        "data": [
                          {
                            "id": "f2328315-64c9-4d8a-bd31-56fef93a4b16",
                            "type": "test_result"
                          }
                        ]
                      }
                    }
                  }
                ],
                "meta": {
                  "total": 2,
                  "search": "os_major_version = 7",
                  "limit": 10,
                  "offset": 1,
                  "sort_by": "score",
                  "relationships": true
                },
                "links": {
                  "first": "/api/compliance/profiles?include=&limit=10&offset=1&relationships=true&search=os_major_version+%3D+7&sort_by=score",
                  "last": "/api/compliance/profiles?include=&limit=10&offset=1&relationships=true&search=os_major_version+%3D+7&sort_by=score"
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "$ref": "#/components/schemas/uuid"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/profile"
                          },
                          "relationships": {
                            "$ref": "#/components/schemas/profile_relationships"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a profile",
        "tags": [
          "profile"
        ],
        "description": "Create a profile with the provided attributes",
        "operationId": "CreateProfile",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "creates a profile",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "1a8b4b6e-27c3-44be-a7f9-0b1a878be4d0",
                  "type": "profile",
                  "attributes": {
                    "ref_id": "xccdf_org.ssgproject.content_profile_5d41f4c1-946d-4257-8e65-2008a87b29b8",
                    "score": 0.0,
                    "parent_profile_id": "a5d161ef-138f-4ca2-b14b-5be34e85eca7",
                    "external": false,
                    "compliance_threshold": 93.5,
                    "os_major_version": "7",
                    "os_version": "7",
                    "policy_profile_id": "1a8b4b6e-27c3-44be-a7f9-0b1a878be4d0",
                    "os_minor_version": "",
                    "parent_profile_ref_id": "xccdf_org.ssgproject.content_profile_5d41f4c1-946d-4257-8e65-2008a87b29b8",
                    "name": "A custom name",
                    "description": "Canonical (Generated) Profile",
                    "canonical": false,
                    "tailored": false,
                    "total_host_count": 2,
                    "ssg_version": "100.0.15",
                    "compliant_host_count": 0,
                    "test_result_host_count": 0,
                    "unsupported_host_count": 0,
                    "business_objective": "LATAM Expansion",
                    "policy_type": "Canonical Profile"
                  },
                  "relationships": {
                    "account": {
                      "data": {
                        "id": "154f2969-164a-446a-b562-a112e9b4c86f",
                        "type": "account"
                      }
                    },
                    "benchmark": {
                      "data": {
                        "id": "946cbd08-4ddf-4e87-88bb-b4484a90f7ae",
                        "type": "benchmark"
                      }
                    },
                    "parent_profile": {
                      "data": {
                        "id": "a5d161ef-138f-4ca2-b14b-5be34e85eca7",
                        "type": "profile"
                      }
                    },
                    "rules": {
                      "data": [
                        {
                          "id": "efba6100-56e1-4b1c-b313-bfb9376723f1",
                          "type": "rule"
                        },
                        {
                          "id": "89028642-62da-4283-b85b-2a07ac0bcad5",
                          "type": "rule"
                        }
                      ]
                    },
                    "hosts": {
                      "data": [
                        {
                          "id": "b1db5193-8074-4302-ba3b-4d68d5883923",
                          "type": "host"
                        },
                        {
                          "id": "cd7ad91c-0857-42bd-815d-a3b4eb568052",
                          "type": "host"
                        }
                      ]
                    },
                    "test_results": {
                      "data": []
                    }
                  }
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "example": "profile"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/profile"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/profile_relationships"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/vnd.api+json": {
              "schema": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "example": "profile"
                  },
                  "data": {
                    "type": "object",
                    "properties": {
                      "type": {
                        "type": "string"
                      },
                      "attributes": {
                        "$ref": "#/components/schemas/profile"
                      },
                      "relationships": {
                        "$ref": "#/components/schemas/profile_relationships"
                      }
                    }
                  }
                },
                "example": {
                  "data": {
                    "attributes": {
                      "name": "my custom profile",
                      "parent_profile_id": "0105a0f0-7379-4897-a891-f95cfb9ddf9c",
                      "description": "This profile contains rules to ensure standard security baseline\\nof a Red Hat Enterprise Linux 7 system. Regardless of your system's workload\\nall of these checks should pass.",
                      "compliance_threshold": 95.0,
                      "business_objective": "APAC Expansion"
                    },
                    "relationships": {
                      "rules": {
                        "data": [
                          {
                            "id": "cc9afa66-3536-4d2e-bc8e-10111d13ec50",
                            "type": "rule"
                          },
                          {
                            "id": "06a19f0e-5c7a-4d54-bc66-e932a96bf954",
                            "type": "rule"
                          }
                        ]
                      },
                      "hosts": {
                        "data": [
                          {
                            "id": "6c3837ed-edac-4522-83a1-147af958f0f2",
                            "type": "host"
                          },
                          {
                            "id": "f896d5e7-e44e-41cb-8e8e-96aab6d895d6",
                            "type": "host"
                          }
                        ]
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/profiles/{id}": {
      "get": {
        "summary": "Retrieve a profile",
        "tags": [
          "profile"
        ],
        "description": "Retrieves data for a profile",
        "operationId": "ShowProfile",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "404": {
            "description": "profile not found",
            "examples": {
              "application/vnd.api+json": {
                "errors": [
                  "Profile not found with ID invalid"
                ]
              }
            }
          },
          "200": {
            "description": "retrieves a profile with included benchmark",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "9d4d40e0-ae85-424a-b8f3-2bf7ea91cba8",
                  "type": "profile",
                  "attributes": {
                    "ref_id": "xccdf_org.ssgproject.content_profile_5628cf4b-396b-4765-a1fd-c2fe03f98e80",
                    "score": 0.42,
                    "parent_profile_id": null,
                    "external": false,
                    "compliance_threshold": 100.0,
                    "os_major_version": "7",
                    "os_version": "7",
                    "policy_profile_id": null,
                    "os_minor_version": "",
                    "parent_profile_ref_id": null,
                    "name": "Canonical Profile",
                    "description": "Canonical (Generated) Profile",
                    "canonical": true,
                    "tailored": false,
                    "total_host_count": 0,
                    "ssg_version": "100.0.19",
                    "compliant_host_count": 0,
                    "test_result_host_count": 0,
                    "unsupported_host_count": 0,
                    "business_objective": null,
                    "policy_type": "Canonical Profile"
                  },
                  "relationships": {
                    "account": {
                      "data": {
                        "id": "af065750-88a1-4c11-843b-50822d091564",
                        "type": "account"
                      }
                    },
                    "benchmark": {
                      "data": {
                        "id": "f9125e75-968c-4b9c-a3b8-b6721b4e1053",
                        "type": "benchmark"
                      }
                    },
                    "parent_profile": {
                      "data": null
                    },
                    "rules": {
                      "data": []
                    },
                    "hosts": {
                      "data": [
                        {
                          "id": "8caeb1a2-669c-456e-b0d3-4896e67836dc",
                          "type": "host"
                        }
                      ]
                    },
                    "test_results": {
                      "data": [
                        {
                          "id": "607ec6d4-07a8-4373-956f-1cd77e19e337",
                          "type": "test_result"
                        }
                      ]
                    }
                  }
                },
                "included": [
                  {
                    "id": "f9125e75-968c-4b9c-a3b8-b6721b4e1053",
                    "type": "benchmark",
                    "attributes": {
                      "ref_id": "xccdf_org.ssgproject.content_benchmark_RHEL-7",
                      "title": "Ea amet ipsa sit.",
                      "version": "100.0.19",
                      "description": "Aut dolorum est. Autem aut ut. Tempora natus qui.",
                      "os_major_version": "7",
                      "latest_supported_os_minor_versions": []
                    },
                    "relationships": {}
                  }
                ]
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/profile"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/profile_relationships"
                        }
                      },
                      "relationships": {
                        "$ref": "#/components/schemas/profile_relationships"
                      }
                    },
                    "included": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "$ref": "#/components/schemas/uuid"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/benchmark"
                          },
                          "relationships": {
                            "type": "object",
                            "properties": {}
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update a profile",
        "tags": [
          "profile"
        ],
        "description": "Updates a profile",
        "operationId": "UpdateProfile",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "404": {
            "description": "profile not found",
            "examples": {
              "application/vnd.api+json": {
                "errors": [
                  "Profile not found with ID invalid"
                ]
              }
            }
          },
          "200": {
            "description": "updates a profile",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "88bf2863-81ba-428e-baf6-3ffae1a53346",
                  "type": "profile",
                  "attributes": {
                    "ref_id": "xccdf_org.ssgproject.content_profile_e44e413d-1ff6-46e9-9650-9c414ec44baf",
                    "score": 0.0,
                    "parent_profile_id": "a8633e69-80b3-4fc4-8b75-63109dc7cd50",
                    "external": false,
                    "compliance_threshold": 93.5,
                    "os_major_version": "7",
                    "os_version": "7",
                    "policy_profile_id": "88bf2863-81ba-428e-baf6-3ffae1a53346",
                    "os_minor_version": "",
                    "parent_profile_ref_id": "xccdf_org.ssgproject.content_profile_aecb2320-9502-4e19-a97f-2f4f657b760b",
                    "name": "Policy for Profile",
                    "description": "An updated custom description",
                    "canonical": false,
                    "tailored": false,
                    "total_host_count": 2,
                    "ssg_version": "100.0.22",
                    "compliant_host_count": 0,
                    "test_result_host_count": 0,
                    "unsupported_host_count": 0,
                    "business_objective": "APAC Expansion",
                    "policy_type": "Canonical Profile"
                  },
                  "relationships": {
                    "account": {
                      "data": {
                        "id": "a2639785-b900-4c9b-a5d0-43ccc461e1a1",
                        "type": "account"
                      }
                    },
                    "benchmark": {
                      "data": {
                        "id": "1d94eeeb-53db-432f-a6b5-9f0eca521795",
                        "type": "benchmark"
                      }
                    },
                    "parent_profile": {
                      "data": {
                        "id": "a8633e69-80b3-4fc4-8b75-63109dc7cd50",
                        "type": "profile"
                      }
                    },
                    "rules": {
                      "data": [
                        {
                          "id": "897ac431-7a2a-4c84-b3b6-8d3c7d5022b1",
                          "type": "rule"
                        },
                        {
                          "id": "3cafcfbd-2618-49f3-9e69-bb907806f5c5",
                          "type": "rule"
                        },
                        {
                          "id": "f0a1a3d5-3dc9-4542-95a7-8f1e75f483e9",
                          "type": "rule"
                        },
                        {
                          "id": "e213bffc-24b1-4464-b93e-41f708628505",
                          "type": "rule"
                        },
                        {
                          "id": "7e401eee-140e-4187-b87f-bbdb02d4f572",
                          "type": "rule"
                        }
                      ]
                    },
                    "hosts": {
                      "data": [
                        {
                          "id": "012cd623-bedd-4fd0-9f27-2bbbbff4822e",
                          "type": "host"
                        },
                        {
                          "id": "f0b5bc20-b67a-4490-a63e-3766c55b4e06",
                          "type": "host"
                        }
                      ]
                    },
                    "test_results": {
                      "data": []
                    }
                  }
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/profile"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/profile_relationships"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/vnd.api+json": {
              "schema": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "example": "profile"
                  },
                  "data": {
                    "type": "object",
                    "properties": {
                      "type": {
                        "type": "string"
                      },
                      "id": {
                        "$ref": "#/components/schemas/uuid"
                      },
                      "attributes": {
                        "$ref": "#/components/schemas/profile"
                      },
                      "relationships": {
                        "$ref": "#/components/schemas/profile_relationships"
                      }
                    }
                  }
                },
                "example": {
                  "data": {
                    "attributes": {
                      "description": "This profile contains rules to ensure standard security baseline\\nof a Red Hat Enterprise Linux 7 system. Regardless of your system's workload\\nall of these checks should pass.",
                      "compliance_threshold": 92.0,
                      "business_objective": "APAC Expansion"
                    },
                    "relationships": {
                      "rules": {
                        "data": [
                          {
                            "id": "cc9afa66-3536-4d2e-bc8e-10111d13ec50",
                            "type": "rule"
                          },
                          {
                            "id": "06a19f0e-5c7a-4d54-bc66-e932a96bf954",
                            "type": "rule"
                          }
                        ]
                      },
                      "hosts": {
                        "data": [
                          {
                            "id": "6c3837ed-edac-4522-83a1-147af958f0f2",
                            "type": "host"
                          },
                          {
                            "id": "f896d5e7-e44e-41cb-8e8e-96aab6d895d6",
                            "type": "host"
                          }
                        ]
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Destroy a profile",
        "tags": [
          "profile"
        ],
        "description": "Destroys a profile",
        "operationId": "DestroyProfile",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "404": {
            "description": "profile not found",
            "examples": {
              "application/vnd.api+json": {
                "errors": [
                  "Profile not found with ID invalid"
                ]
              }
            }
          },
          "202": {
            "description": "destroys a profile",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "e0b00cb9-3ccc-4448-b063-bb6bdfb86687",
                  "type": "profile",
                  "attributes": {
                    "ref_id": "xccdf_org.ssgproject.content_profile_578dda94-4338-442c-8633-a9c6c37d2913",
                    "score": 0.0,
                    "parent_profile_id": "b9a7ff3c-2383-4755-903b-f774ef659dbe",
                    "external": false,
                    "compliance_threshold": 100.0,
                    "os_major_version": "7",
                    "os_version": "7",
                    "policy_profile_id": null,
                    "os_minor_version": "",
                    "parent_profile_ref_id": "xccdf_org.ssgproject.content_profile_578dda94-4338-442c-8633-a9c6c37d2913",
                    "name": "In harum vel eos.",
                    "description": "Quia est repudiandae. Ratione nesciunt exercitationem. Qui culpa nihil.",
                    "canonical": false,
                    "tailored": false,
                    "total_host_count": 0,
                    "ssg_version": "100.0.25",
                    "compliant_host_count": 0,
                    "test_result_host_count": 0,
                    "unsupported_host_count": 0,
                    "business_objective": null,
                    "policy_type": "Beatae consequatur porro ut."
                  },
                  "relationships": {
                    "account": {
                      "data": {
                        "id": "63e6b85e-37f2-4a6a-9248-a50253d2346e",
                        "type": "account"
                      }
                    },
                    "benchmark": {
                      "data": {
                        "id": "bbfcd3fc-6907-4cf6-9ec0-6feb15447abe",
                        "type": "benchmark"
                      }
                    },
                    "parent_profile": {
                      "data": {
                        "id": "b9a7ff3c-2383-4755-903b-f774ef659dbe",
                        "type": "profile"
                      }
                    },
                    "rules": {
                      "data": []
                    },
                    "hosts": {
                      "data": []
                    },
                    "test_results": {
                      "data": []
                    }
                  }
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/profile"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/profile_relationships"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/rule_results": {
      "get": {
        "summary": "List all rule_results",
        "tags": [
          "rule_result"
        ],
        "description": "Lists all rule_results requested",
        "operationId": "ListRuleResults",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to return",
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 10
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to skip before starting to collect the result set",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "search",
            "in": "query",
            "required": false,
            "type": "string",
            "description": "Query string compliant with scoped_search query language: https://github.com/wvanbergen/scoped_search/wiki/Query-language",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "required": false,
            "type": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "description": "An array of fields with an optional direction (:asc or :desc) to sort the results.",
            "schema": {
              "type": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "array"
                  }
                ]
              },
              "items": {
                "enum": [
                  "result",
                  "result:asc",
                  "result:desc"
                ]
              },
              "default": ""
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "200": {
            "description": "lists all rule_results requested",
            "examples": {
              "application/vnd.api+json": {
                "data": [
                  {
                    "id": "a9082206-34a0-4460-bacf-8c6d220aca7d",
                    "type": "rule_result",
                    "attributes": {
                      "result": "pass"
                    },
                    "relationships": {
                      "host": {
                        "data": {
                          "id": "1aae4c5e-5e15-40f9-95df-48d15a496a18",
                          "type": "host"
                        }
                      },
                      "rule": {
                        "data": {
                          "id": "1e3794c6-effc-4206-a765-1cbd09b11e2f",
                          "type": "rule"
                        }
                      }
                    }
                  }
                ],
                "meta": {
                  "total": 1,
                  "limit": 10,
                  "offset": 1,
                  "relationships": true
                },
                "links": {
                  "first": "/api/compliance/rule_results?include=&limit=10&offset=1&relationships=true",
                  "last": "/api/compliance/rule_results?include=&limit=10&offset=1&relationships=true"
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/rule_result"
                          },
                          "relationships": {
                            "$ref": "#/components/schemas/rule_result_relationships"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/rules": {
      "get": {
        "summary": "List all rules",
        "tags": [
          "rule"
        ],
        "description": "Lists all rules requested",
        "operationId": "ListRules",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to return",
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 10
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to skip before starting to collect the result set",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "search",
            "in": "query",
            "required": false,
            "type": "string",
            "description": "Query string compliant with scoped_search query language: https://github.com/wvanbergen/scoped_search/wiki/Query-language",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "required": false,
            "type": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "description": "An array of fields with an optional direction (:asc or :desc) to sort the results.",
            "schema": {
              "type": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "array"
                  }
                ]
              },
              "items": {
                "enum": [
                  "title",
                  "precedence",
                  "severity",
                  "remediation_available",
                  "title:asc",
                  "title:desc",
                  "precedence:asc",
                  "precedence:desc",
                  "severity:asc",
                  "severity:desc",
                  "remediation_available:asc",
                  "remediation_available:desc"
                ]
              },
              "default": ""
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "200": {
            "description": "lists all rules requested",
            "examples": {
              "application/vnd.api+json": {
                "data": [
                  {
                    "id": "2f65ed48-3e38-4d67-be87-b4d9e8f4f945",
                    "type": "rule",
                    "attributes": {
                      "ref_id": "foo_rule_e77f5b3b-08a3-4627-8251-9c6541113bab",
                      "remediation_issue_id": null,
                      "title": "Pariatur veritatis dolores et.",
                      "rationale": "Repellat a porro. Rem ea quidem. Ut et ab.",
                      "description": "Quisquam pariatur laborum. Eligendi necessitatibus sit. Aliquid ipsam commodi.",
                      "severity": "high",
                      "slug": "foo_rule_e77f5b3b-08a3-4627-8251-9c6541113bab",
                      "precedence": 1
                    },
                    "relationships": {
                      "benchmark": {
                        "data": {
                          "id": "04f97e86-0c92-4f32-85c9-8c72bdab079b",
                          "type": "benchmark"
                        }
                      },
                      "profiles": {
                        "data": [
                          {
                            "id": "1e618cef-b1fc-45dd-b384-fb5db7ff70ae",
                            "type": "profile"
                          },
                          {
                            "id": "d4376d00-c5d1-4c74-932a-d31891680467",
                            "type": "profile"
                          }
                        ]
                      },
                      "rule_identifier": {
                        "data": null
                      }
                    }
                  }
                ],
                "meta": {
                  "total": 1,
                  "limit": 10,
                  "offset": 1,
                  "relationships": true
                },
                "links": {
                  "first": "/api/compliance/rules?include=&limit=10&offset=1&relationships=true",
                  "last": "/api/compliance/rules?include=&limit=10&offset=1&relationships=true"
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/rule"
                          },
                          "relationships": {
                            "$ref": "#/components/schemas/rule_relationships"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/rules/{id}": {
      "get": {
        "summary": "Retrieve a rule",
        "tags": [
          "rule"
        ],
        "description": "Retrieves data for a rule",
        "operationId": "ShowRule",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "404": {
            "description": "rule not found",
            "examples": {
              "application/vnd.api+json": {
                "errors": [
                  "Rule not found with ID c39d4c1e-8e14-4bd9-ba93-9e3219c25071"
                ]
              }
            }
          },
          "200": {
            "description": "retrieves a rule",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "31402c55-3974-4393-bd5d-f6495e11c3dc",
                  "type": "rule",
                  "attributes": {
                    "ref_id": "foo_rule_3fd16564-783c-49e6-abf3-4ecca6e75500",
                    "remediation_issue_id": null,
                    "title": "Et reiciendis vel rem.",
                    "rationale": "Qui molestias ea. Ut nihil repellat. Et eos et.",
                    "description": "Consectetur in eligendi. Dolor ab nisi. Ratione accusantium aut.",
                    "severity": "low",
                    "slug": "foo_rule_3fd16564-783c-49e6-abf3-4ecca6e75500",
                    "precedence": 1
                  },
                  "relationships": {
                    "benchmark": {
                      "data": {
                        "id": "90083f93-0d29-4622-b4a6-3be7988f9ed9",
                        "type": "benchmark"
                      }
                    },
                    "profiles": {
                      "data": [
                        {
                          "id": "e0cede7a-2ce9-4d47-a866-0be32d84653c",
                          "type": "profile"
                        },
                        {
                          "id": "5ffae649-48d2-4736-b1b4-6f99b258c8b7",
                          "type": "profile"
                        }
                      ]
                    },
                    "rule_identifier": {
                      "data": null
                    }
                  }
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/rule"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/rule_relationships"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/status": {
      "get": {
        "summary": "status",
        "tags": [
          "status"
        ],
        "description": "Display Compliance status",
        "operationId": "Status",
        "responses": {
          "200": {
            "description": "successful status",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "api": true
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "$ref": "#/components/schemas/status"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "unsuccessful status",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "api": false
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "$ref": "#/components/schemas/status"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/supported_ssgs": {
      "get": {
        "summary": "List all supported SSGs",
        "tags": [
          "supported_ssg"
        ],
        "description": "List all supported SSGs mapped to RHEL minor version",
        "operationId": "ListSupportedSsgs",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "200": {
            "description": "lists all supported_ssgs requested",
            "examples": {
              "application/vnd.api+json": {
                "data": [
                  {
                    "id": "RHEL-6.6:scap-security-guide-0.1.18-3.el6",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.18-3.el6",
                      "version": "0.1.18",
                      "os_major_version": "6",
                      "os_minor_version": "6",
                      "profiles": [
                        "C2S",
                        "common",
                        "CS2",
                        "CSCF-RHEL6-MLS",
                        "rht-ccp",
                        "server",
                        "stig-rhel6-server-upstream",
                        "test",
                        "usgcb-rhel6-server"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-6.7:scap-security-guide-0.1.21-3.el6",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.21-3.el6",
                      "version": "0.1.21",
                      "os_major_version": "6",
                      "os_minor_version": "7",
                      "profiles": [
                        "C2S",
                        "common",
                        "CS2",
                        "CSCF-RHEL6-MLS",
                        "rht-ccp",
                        "server",
                        "stig-rhel6-server-upstream",
                        "usgcb-rhel6-server"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-6.8:scap-security-guide-0.1.28-2.el6",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.28-2.el6",
                      "version": "0.1.28",
                      "os_major_version": "6",
                      "os_minor_version": "8",
                      "profiles": [
                        "C2S",
                        "common",
                        "CS2",
                        "CSCF-RHEL6-MLS",
                        "nist-cl-il-al",
                        "pci-dss",
                        "rht-ccp",
                        "server",
                        "standard",
                        "stig-rhel6-server-upstream",
                        "usgcb-rhel6-server"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-6.9:scap-security-guide-0.1.28-3.el6",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.28-3.el6",
                      "version": "0.1.28",
                      "os_major_version": "6",
                      "os_minor_version": "9",
                      "profiles": [
                        "C2S",
                        "common",
                        "CS2",
                        "CSCF-RHEL6-MLS",
                        "nist-cl-il-al",
                        "pci-dss",
                        "rht-ccp",
                        "server",
                        "standard",
                        "stig-rhel6-server-upstream",
                        "usgcb-rhel6-server"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-6.10:scap-security-guide-0.1.28-4.el6",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.28-4.el6",
                      "version": "0.1.28",
                      "os_major_version": "6",
                      "os_minor_version": "10",
                      "profiles": [
                        "C2S",
                        "common",
                        "CS2",
                        "CSCF-RHEL6-MLS",
                        "nist-cl-il-al",
                        "pci-dss",
                        "rht-ccp",
                        "server",
                        "standard",
                        "stig-rhel6-server-upstream",
                        "usgcb-rhel6-server"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.1:scap-security-guide-0.1.19-2.el7",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.19-2.el7",
                      "version": "0.1.19",
                      "os_major_version": "7",
                      "os_minor_version": "1",
                      "profiles": [
                        "rht-ccp"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.2:scap-security-guide-0.1.25-3.el7",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.25-3.el7",
                      "version": "0.1.25",
                      "os_major_version": "7",
                      "os_minor_version": "2",
                      "profiles": [
                        "common",
                        "pci-dss",
                        "rht-ccp",
                        "standard",
                        "stig-rhel7-server-upstream"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.3:scap-security-guide-0.1.30-5.el7_3",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.30-5.el7_3",
                      "version": "0.1.30",
                      "os_major_version": "7",
                      "os_minor_version": "3",
                      "profiles": [
                        "C2S",
                        "cjis-rhel7-server",
                        "common",
                        "nist-cl-il-al",
                        "ospp-rhel7-server",
                        "pci-dss",
                        "rht-ccp",
                        "standard",
                        "stig-rhel7-server-gui-upstream",
                        "stig-rhel7-server-upstream",
                        "stig-rhel7-workstation-upstream"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.4:scap-security-guide-0.1.33-6.el7_4",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.33-6.el7_4",
                      "version": "0.1.33",
                      "os_major_version": "7",
                      "os_minor_version": "4",
                      "profiles": [
                        "C2S",
                        "cjis-rhel7-server",
                        "common",
                        "docker-host",
                        "nist-800-171-cui",
                        "ospp-rhel7",
                        "pci-dss_centric",
                        "pci-dss",
                        "rht-ccp",
                        "standard",
                        "stig-rhel7-disa",
                        "stig-rhevh-upstream"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.5:scap-security-guide-0.1.36-10.el7_5",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.36-10.el7_5",
                      "version": "0.1.36",
                      "os_major_version": "7",
                      "os_minor_version": "5",
                      "profiles": [
                        "C2S",
                        "cjis-rhel7-server",
                        "common",
                        "docker-host",
                        "nist-800-171-cui",
                        "ospp-rhel7",
                        "pci-dss_centric",
                        "pci-dss",
                        "rht-ccp",
                        "standard",
                        "stig-rhel7-disa",
                        "stig-rhevh-upstream"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.6:scap-security-guide-0.1.40-13.el7_6",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.40-13.el7_6",
                      "version": "0.1.40",
                      "os_major_version": "7",
                      "os_minor_version": "6",
                      "profiles": [
                        "C2S",
                        "cjis",
                        "hipaa",
                        "nist-800-171-cui",
                        "ospp42",
                        "ospp",
                        "pci-dss_centric",
                        "pci-dss",
                        "rht-ccp",
                        "standard",
                        "stig-rhel7-disa"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.7:scap-security-guide-0.1.43-13.el7",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.43-13.el7",
                      "version": "0.1.43",
                      "os_major_version": "7",
                      "os_minor_version": "7",
                      "profiles": [
                        "C2S",
                        "cjis",
                        "hipaa",
                        "nist-800-171-cui",
                        "ospp42",
                        "ospp",
                        "pci-dss_centric",
                        "pci-dss",
                        "rhelh-vpp",
                        "rht-ccp",
                        "standard",
                        "stig-rhel7-disa"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.8:scap-security-guide-0.1.46-11.el7",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.46-11.el7",
                      "version": "0.1.46",
                      "os_major_version": "7",
                      "os_minor_version": "8",
                      "profiles": [
                        "anssi_nt28_enhanced",
                        "anssi_nt28_high",
                        "anssi_nt28_intermediary",
                        "anssi_nt28_minimal",
                        "C2S",
                        "cjis",
                        "cui",
                        "e8",
                        "hipaa",
                        "ncp",
                        "ospp",
                        "pci-dss_centric",
                        "pci-dss",
                        "rhelh-stig",
                        "rhelh-vpp",
                        "rht-ccp",
                        "standard",
                        "stig"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.9:scap-security-guide-0.1.49-13.el7",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.49-13.el7",
                      "version": "0.1.49",
                      "os_major_version": "7",
                      "os_minor_version": "9",
                      "profiles": [
                        "anssi_nt28_enhanced",
                        "anssi_nt28_high",
                        "anssi_nt28_intermediary",
                        "anssi_nt28_minimal",
                        "C2S",
                        "cis",
                        "cjis",
                        "cui",
                        "e8",
                        "hipaa",
                        "ncp",
                        "ospp",
                        "pci-dss_centric",
                        "pci-dss",
                        "rhelh-stig",
                        "rhelh-vpp",
                        "rht-ccp",
                        "standard",
                        "stig"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.9:scap-security-guide-0.1.52-2.el7_9",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.52-2.el7_9",
                      "version": "0.1.52",
                      "os_major_version": "7",
                      "os_minor_version": "9",
                      "profiles": [
                        "anssi_nt28_enhanced",
                        "anssi_nt28_high",
                        "anssi_nt28_intermediary",
                        "anssi_nt28_minimal",
                        "C2S",
                        "cis",
                        "cjis",
                        "cui",
                        "e8",
                        "hipaa",
                        "ncp",
                        "ospp",
                        "pci-dss_centric",
                        "pci-dss",
                        "rhelh-stig",
                        "rhelh-vpp",
                        "rht-ccp",
                        "standard",
                        "stig"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.9:scap-security-guide-0.1.54-7.el7_9",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.54-7.el7_9",
                      "version": "0.1.54",
                      "os_major_version": "7",
                      "os_minor_version": "9",
                      "profiles": [
                        "anssi_nt28_enhanced",
                        "anssi_nt28_high",
                        "anssi_nt28_intermediary",
                        "anssi_nt28_minimal",
                        "C2S",
                        "cis",
                        "cjis",
                        "cui",
                        "e8",
                        "hipaa",
                        "ncp",
                        "ospp",
                        "pci-dss_centric",
                        "pci-dss",
                        "rhelh-stig",
                        "rhelh-vpp",
                        "rht-ccp",
                        "standard",
                        "stig"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-7.9:scap-security-guide-0.1.57-8.el7_9",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.57-8.el7_9",
                      "version": "0.1.57",
                      "os_major_version": "7",
                      "os_minor_version": "9",
                      "profiles": [
                        "anssi_nt28_enhanced",
                        "anssi_nt28_high",
                        "anssi_nt28_intermediary",
                        "anssi_nt28_minimal",
                        "C2S",
                        "cis",
                        "cis_server_l1",
                        "cis_workstation_l1",
                        "cis_workstation_l2",
                        "cjis",
                        "cui",
                        "e8",
                        "hipaa",
                        "ncp",
                        "ospp",
                        "pci-dss_centric",
                        "pci-dss",
                        "rhelh-stig",
                        "rhelh-vpp",
                        "rht-ccp",
                        "standard",
                        "stig",
                        "stig_gui"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.0:scap-security-guide-0.1.42-11.el8",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.42-11.el8",
                      "version": "0.1.42",
                      "os_major_version": "8",
                      "os_minor_version": "0",
                      "profiles": [
                        "ospp",
                        "pci-dss"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.1:scap-security-guide-0.1.46-1.el8",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.46-1.el8",
                      "version": "0.1.46",
                      "os_major_version": "8",
                      "os_minor_version": "1",
                      "profiles": [
                        "ospp",
                        "pci-dss"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.1:scap-security-guide-0.1.47-8.el8_1",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.47-8.el8_1",
                      "version": "0.1.47",
                      "os_major_version": "8",
                      "os_minor_version": "1",
                      "profiles": [
                        "ospp",
                        "pci-dss"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.2:scap-security-guide-0.1.48-10.el8_2",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.48-10.el8_2",
                      "version": "0.1.48",
                      "os_major_version": "8",
                      "os_minor_version": "2",
                      "profiles": [
                        "e8",
                        "ospp",
                        "pci-dss",
                        "stig"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.3:scap-security-guide-0.1.50-16.el8_3",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.50-16.el8_3",
                      "version": "0.1.50",
                      "os_major_version": "8",
                      "os_minor_version": "3",
                      "profiles": [
                        "cis",
                        "cui",
                        "e8",
                        "hipaa",
                        "ospp",
                        "pci-dss",
                        "stig"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.4:scap-security-guide-0.1.54-5.el8",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.54-5.el8",
                      "version": "0.1.54",
                      "os_major_version": "8",
                      "os_minor_version": "4",
                      "profiles": [
                        "anssi_bp28_enhanced",
                        "anssi_bp28_intermediary",
                        "anssi_bp28_minimal",
                        "cis",
                        "cui",
                        "e8",
                        "hipaa",
                        "ospp",
                        "pci-dss",
                        "stig"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.4:scap-security-guide-0.1.57-10.el8_4",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.57-10.el8_4",
                      "version": "0.1.57",
                      "os_major_version": "8",
                      "os_minor_version": "4",
                      "profiles": [
                        "anssi_bp28_enhanced",
                        "anssi_bp28_high",
                        "anssi_bp28_intermediary",
                        "anssi_bp28_minimal",
                        "cis",
                        "cis_server_l1",
                        "cis_workstation_l1",
                        "cis_workstation_l2",
                        "cui",
                        "e8",
                        "hipaa",
                        "ism_o",
                        "ospp",
                        "pci-dss",
                        "stig",
                        "stig_gui"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.4:scap-security-guide-0.1.63-3.el8_4",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.63-3.el8_4",
                      "version": "0.1.63",
                      "os_major_version": "8",
                      "os_minor_version": "4",
                      "profiles": [
                        "anssi_bp28_enhanced",
                        "anssi_bp28_high",
                        "anssi_bp28_intermediary",
                        "anssi_bp28_minimal",
                        "cis",
                        "cis_server_l1",
                        "cis_workstation_l1",
                        "cis_workstation_l2",
                        "cui",
                        "e8",
                        "hipaa",
                        "ism_o",
                        "ospp",
                        "pci-dss",
                        "stig",
                        "stig_gui"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.5:scap-security-guide-0.1.57-5.el8",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.57-5.el8",
                      "version": "0.1.57",
                      "os_major_version": "8",
                      "os_minor_version": "5",
                      "profiles": [
                        "anssi_bp28_enhanced",
                        "anssi_bp28_high",
                        "anssi_bp28_intermediary",
                        "anssi_bp28_minimal",
                        "cis",
                        "cis_server_l1",
                        "cis_workstation_l1",
                        "cis_workstation_l2",
                        "cui",
                        "e8",
                        "hipaa",
                        "ism_o",
                        "ospp",
                        "pci-dss",
                        "stig",
                        "stig_gui"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.5:scap-security-guide-0.1.57-9.el8_5",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.57-9.el8_5",
                      "version": "0.1.57",
                      "os_major_version": "8",
                      "os_minor_version": "5",
                      "profiles": [
                        "anssi_bp28_enhanced",
                        "anssi_bp28_high",
                        "anssi_bp28_intermediary",
                        "anssi_bp28_minimal",
                        "cis",
                        "cis_server_l1",
                        "cis_workstation_l1",
                        "cis_workstation_l2",
                        "cui",
                        "e8",
                        "hipaa",
                        "ism_o",
                        "ospp",
                        "pci-dss",
                        "stig",
                        "stig_gui"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-8.6:scap-security-guide-0.1.60-9.el8_6",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.60-9.el8_6",
                      "version": "0.1.60",
                      "os_major_version": "8",
                      "os_minor_version": "6",
                      "profiles": [
                        "anssi_bp28_enhanced",
                        "anssi_bp28_high",
                        "anssi_bp28_intermediary",
                        "anssi_bp28_minimal",
                        "cis",
                        "cis_server_l1",
                        "cis_workstation_l1",
                        "cis_workstation_l2",
                        "cui",
                        "e8",
                        "hipaa",
                        "ism_o",
                        "ospp",
                        "pci-dss",
                        "stig",
                        "stig_gui"
                      ]
                    }
                  },
                  {
                    "id": "RHEL-9.0:scap-security-guide-0.1.60-6.el9_0",
                    "type": "supported_ssg",
                    "attributes": {
                      "package": "scap-security-guide-0.1.60-6.el9_0",
                      "version": "0.1.60",
                      "os_major_version": "9",
                      "os_minor_version": "0",
                      "profiles": [
                        "anssi_bp28_enhanced",
                        "anssi_bp28_high",
                        "anssi_bp28_intermediary",
                        "anssi_bp28_minimal",
                        "cis",
                        "cis_server_l1",
                        "cis_workstation_l1",
                        "cis_workstation_l2",
                        "cui",
                        "e8",
                        "hipaa",
                        "ism_o",
                        "ospp",
                        "pci-dss",
                        "stig",
                        "stig_gui"
                      ]
                    }
                  }
                ],
                "meta": {
                  "total": 29,
                  "revision": "2022-08-18"
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "type": "string"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/supported_ssg"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/systems": {
      "get": {
        "summary": "List all hosts",
        "tags": [
          "host"
        ],
        "description": "Lists all hosts requested",
        "operationId": "ListHosts",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to return",
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 10
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "type": "integer",
            "description": "The number of items to skip before starting to collect the result set",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "search",
            "in": "query",
            "required": false,
            "type": "string",
            "description": "Query string compliant with scoped_search query language: https://github.com/wvanbergen/scoped_search/wiki/Query-language",
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "name": "tags",
            "in": "query",
            "required": false,
            "type": "array",
            "description": "An array of tags to narrow down the results against.",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ""
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "required": false,
            "type": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "type": "array"
                }
              ]
            },
            "description": "An array of fields with an optional direction (:asc or :desc) to sort the results.",
            "schema": {
              "type": {
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "array"
                  }
                ]
              },
              "items": {
                "enum": [
                  "name",
                  "os_major_version",
                  "os_minor_version",
                  "ssg_version",
                  "name:asc",
                  "name:desc",
                  "os_major_version:asc",
                  "os_major_version:desc",
                  "os_minor_version:asc",
                  "os_minor_version:desc",
                  "ssg_version:asc",
                  "ssg_version:desc"
                ]
              },
              "default": ""
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "200": {
            "description": "lists all hosts requested",
            "examples": {
              "application/vnd.api+json": {
                "data": [
                  {
                    "id": "ee69f645-2bf9-403b-9f87-a8d5b6cbd6e4",
                    "type": "host",
                    "attributes": {
                      "name": "donnelly.info",
                      "os_major_version": 7,
                      "os_minor_version": 9,
                      "last_scanned": "2022-09-20T09:19:26Z",
                      "rules_passed": 0,
                      "rules_failed": 0,
                      "has_policy": true,
                      "culled_timestamp": "2032-10-04T09:19:26Z",
                      "stale_timestamp": "2032-09-20T09:19:26Z",
                      "stale_warning_timestamp": "2032-09-27T09:19:26Z",
                      "updated": "2022-09-20T09:19:26Z",
                      "insights_id": null,
                      "compliant": false
                    },
                    "relationships": {
                      "test_results": {
                        "data": [
                          {
                            "id": "9f63e648-2bd7-46ac-8dca-e0fe0a7a7505",
                            "type": "test_result"
                          }
                        ]
                      },
                      "profiles": {
                        "data": [
                          {
                            "id": "46f8018a-52d4-4ee4-9605-e1ff11657eba",
                            "type": "profile"
                          }
                        ]
                      }
                    }
                  }
                ],
                "meta": {
                  "total": 1,
                  "search": "has_test_results=true or has_policy=true",
                  "tags": [
                    "foo/bar=baz"
                  ],
                  "limit": 10,
                  "offset": 1,
                  "relationships": true
                },
                "links": {
                  "first": "/api/compliance/systems?include=&limit=10&offset=1&relationships=true&search=has_test_results%3Dtrue+or+has_policy%3Dtrue&tags=foo%2Fbar%3Dbaz",
                  "last": "/api/compliance/systems?include=&limit=10&offset=1&relationships=true&search=has_test_results%3Dtrue+or+has_policy%3Dtrue&tags=foo%2Fbar%3Dbaz"
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "id": {
                            "$ref": "#/components/schemas/uuid"
                          },
                          "attributes": {
                            "$ref": "#/components/schemas/host"
                          },
                          "relationships": {
                            "$ref": "#/components/schemas/host_relationships"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/compliance/systems/{id}": {
      "get": {
        "summary": "Retrieve a system",
        "tags": [
          "host"
        ],
        "description": "Lists all hosts requested",
        "operationId": "ListHosts",
        "parameters": [
          {
            "name": "X-RH-IDENTITY",
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include",
            "in": "query",
            "type": "string",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "A comma seperated list of resources to include in the response"
          }
        ],
        "responses": {
          "404": {
            "description": "system not found",
            "examples": {
              "application/vnd.api+json": {
                "errors": [
                  "Host not found with ID invalid"
                ]
              }
            }
          },
          "200": {
            "description": "retrieves a system",
            "examples": {
              "application/vnd.api+json": {
                "data": {
                  "id": "7f83bce1-4aa0-406f-92f5-b9dda6b3d5b7",
                  "type": "host",
                  "attributes": {
                    "name": "hettinger.biz",
                    "os_major_version": 7,
                    "os_minor_version": 9,
                    "last_scanned": "2022-09-20T09:19:26Z",
                    "rules_passed": 0,
                    "rules_failed": 0,
                    "has_policy": true,
                    "culled_timestamp": "2032-10-04T09:19:26Z",
                    "stale_timestamp": "2032-09-20T09:19:26Z",
                    "stale_warning_timestamp": "2032-09-27T09:19:26Z",
                    "updated": "2022-09-20T09:19:26Z",
                    "insights_id": null,
                    "compliant": false
                  },
                  "relationships": {
                    "test_results": {
                      "data": [
                        {
                          "id": "30ccd262-3b9c-4840-b7ba-4b701c8d04b0",
                          "type": "test_result"
                        }
                      ]
                    },
                    "profiles": {
                      "data": [
                        {
                          "id": "5d499da5-661a-448d-90ae-05fdb1bad5e5",
                          "type": "profile"
                        }
                      ]
                    }
                  }
                }
              }
            },
            "content": {
              "application/vnd.api+json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "meta": {
                      "$ref": "#/components/schemas/metadata"
                    },
                    "links": {
                      "$ref": "#/components/schemas/links"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string"
                        },
                        "id": {
                          "$ref": "#/components/schemas/uuid"
                        },
                        "attributes": {
                          "$ref": "#/components/schemas/host"
                        },
                        "relationships": {
                          "$ref": "#/components/schemas/host_relationships"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "uuid": {
        "type": "string",
        "format": "uuid"
      },
      "relationship": {
        "type": "object",
        "properties": {
          "data": {
            "type": "object",
            "nullable": true,
            "properties": {
              "id": {
                "$ref": "#/components/schemas/uuid"
              },
              "type": {
                "type": "string"
              }
            }
          }
        }
      },
      "relationship_collection": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "properties": {
                "id": {
                  "$ref": "#/components/schemas/uuid"
                },
                "type": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "error": {
        "type": "object",
        "required": [
          "code",
          "detail",
          "status",
          "title"
        ],
        "properties": {
          "status": {
            "type": "integer",
            "description": "the HTTP status code applicable to this problem, expressed as a string value.",
            "minimum": 100,
            "maximum": 600
          },
          "code": {
            "type": "string",
            "description": "an application-specific error code, expressed as a string value."
          },
          "title": {
            "type": "string",
            "description": "a short, human-readable summary of the problem that SHOULD NOT change from occurrence to occurrence of the problem, except for purposes of localization."
          },
          "detail": {
            "type": "string",
            "description": "a human-readable explanation specific to this occurrence of the problem. Like title, this fields value can be localized."
          }
        }
      },
      "metadata": {
        "type": "object",
        "properties": {
          "filter": {
            "type": "string",
            "example": "name='Standard System Security Profile for Fedora'"
          }
        }
      },
      "tags": {
        "type": "array",
        "items": {
          "type": "string",
          "properties": {
            "type": "string",
            "example": "insights/environment=production"
          }
        }
      },
      "host": {
        "type": "object",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string",
            "example": "console.redhat.com"
          },
          "compliant": {
            "type": "boolean",
            "example": true
          },
          "has_policy": {
            "type": "boolean",
            "example": true
          },
          "os_major_version": {
            "type": "integer",
            "example": 7,
            "nullable": true
          },
          "os_minor_version": {
            "type": "integer",
            "example": 3,
            "nullable": true
          },
          "last_scanned": {
            "type": "string",
            "example": "2020-06-04T19:31:55Z"
          },
          "rules_passed": {
            "type": "integer",
            "example": 34
          },
          "rules_failed": {
            "type": "integer",
            "example": 12
          },
          "culled_timestamp": {
            "type": "string",
            "example": "2020-06-04T19:31:55Z"
          },
          "stale_warning_timestamp": {
            "type": "string",
            "example": "2020-06-04T19:31:55Z"
          },
          "stale_timestamp": {
            "type": "string",
            "example": "2020-06-04T19:31:55Z"
          },
          "updated": {
            "type": "string",
            "example": "2020-06-04T19:31:55Z"
          },
          "insights_id": {
            "type": "uuid",
            "example": "374399b7-e6ba-49b7-a405-9b620a2bd0b3"
          }
        }
      },
      "host_relationships": {
        "type": "object",
        "properties": {
          "profiles": {
            "$ref": "#/components/schemas/relationship_collection"
          },
          "test_results": {
            "$ref": "#/components/schemas/relationship_collection"
          }
        }
      },
      "links": {
        "type": "object",
        "properties": {
          "self": {
            "type": "string",
            "example": "https://compliance.insights.openshift.org/profiles"
          }
        }
      },
      "benchmark": {
        "type": "object",
        "required": [
          "ref_id",
          "title",
          "version"
        ],
        "properties": {
          "ref_id": {
            "type": "string",
            "example": "xccdf_org.ssgproject.content_benchmark_RHEL-7"
          },
          "title": {
            "type": "string",
            "example": "Guide to the Secure Configuration of Red Hat Enterprise Linux 7"
          },
          "version": {
            "type": "string",
            "example": "0.1.46"
          },
          "description": {
            "type": "string"
          },
          "os_major_version": {
            "type": "string"
          },
          "latest_supported_os_minor_versions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "benchmark_relationships": {
        "type": "object",
        "properties": {
          "rules": {
            "$ref": "#/components/schemas/relationship_collection"
          },
          "profiles": {
            "$ref": "#/components/schemas/relationship_collection"
          }
        }
      },
      "business_objective": {
        "type": "object",
        "required": [
          "title"
        ],
        "properties": {
          "title": {
            "type": "string",
            "example": "Guide to the Secure Configuration of Red Hat Enterprise Linux 7"
          }
        }
      },
      "business_objective_relationships": {
        "type": "object",
        "properties": {
          "profiles": {
            "$ref": "#/components/schemas/relationship_collection"
          }
        }
      },
      "profile": {
        "type": "object",
        "required": [
          "parent_profile_id"
        ],
        "properties": {
          "name": {
            "type": "string",
            "example": "my custom profile"
          },
          "parent_profile_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "example": "0105a0f0-7379-4897-a891-f95cfb9ddf9c",
            "required": true
          },
          "parent_profile_ref_id": {
            "type": "string",
            "nullable": true,
            "example": "xccdf_org.ssgproject.content_profile_standard"
          },
          "description": {
            "type": "string",
            "nullable": true,
            "example": "This profile contains rules to ensure standard security baseline\\nof a Red Hat Enterprise Linux 7 system. Regardless of your system's workload\\nall of these checks should pass."
          },
          "compliance_threshold": {
            "type": "number",
            "example": 95.0
          },
          "score": {
            "type": "number",
            "example": 63.154762
          },
          "business_objective": {
            "type": "string",
            "example": "APAC Expansion",
            "nullable": true
          },
          "canonical": {
            "type": "boolean",
            "example": true
          },
          "ssg_version": {
            "type": "string",
            "example": "0.1.49"
          },
          "total_host_count": {
            "type": "integer",
            "example": 5
          },
          "compliant_host_count": {
            "type": "integer",
            "example": 3
          },
          "test_result_host_count": {
            "type": "integer",
            "example": 4
          },
          "unsupported_host_count": {
            "type": "integer",
            "example": 3
          },
          "external": {
            "type": "boolean",
            "example": false
          },
          "tailored": {
            "type": "boolean",
            "example": false
          },
          "policy_profile_id": {
            "type": "uuid",
            "example": "374399b7-e6ba-49b7-a405-9b620a2bd0b3"
          },
          "os_major_version": {
            "type": "string",
            "example": "7"
          },
          "os_minor_version": {
            "type": "string",
            "example": "4"
          },
          "os_version": {
            "type": "string",
            "example": "7.4"
          },
          "policy_type": {
            "type": "string",
            "example": "Australian Cyber Security Centre (ACSC) Essential Eight"
          }
        }
      },
      "profile_relationships": {
        "type": "object",
        "properties": {
          "account": {
            "$ref": "#/components/schemas/relationship"
          },
          "benchmark": {
            "$ref": "#/components/schemas/relationship"
          },
          "parent_profile": {
            "$ref": "#/components/schemas/relationship"
          },
          "rules": {
            "$ref": "#/components/schemas/relationship_collection"
          },
          "hosts": {
            "$ref": "#/components/schemas/relationship_collection"
          },
          "test_results": {
            "$ref": "#/components/schemas/relationship_collection"
          }
        }
      },
      "rule_result": {
        "type": "object",
        "required": [
          "result"
        ],
        "properties": {
          "result": {
            "type": "string",
            "example": "passed"
          }
        }
      },
      "rule_result_relationships": {
        "type": "object",
        "properties": {
          "hosts": {
            "$ref": "#/components/schemas/relationship_collection"
          },
          "rules": {
            "$ref": "#/components/schemas/relationship_collection"
          }
        }
      },
      "rule": {
        "type": "object",
        "required": [
          "title",
          "ref_id"
        ],
        "properties": {
          "title": {
            "type": "string",
            "example": "Record Access Events to Audit Log directory"
          },
          "ref_id": {
            "type": "string",
            "example": "xccdf_org.ssgproject.content_rule_directory_access_var_log_audit"
          },
          "remediation_issue_id": {
            "type": "string",
            "nullable": true,
            "example": "ssg:rhel7|rhelh-stig|xccdf_org.ssgproject.content_rule_no_empty_passwords"
          },
          "precedence": {
            "type": "integer",
            "example": 3
          },
          "severity": {
            "type": "string",
            "example": "Low"
          },
          "description": {
            "type": "string",
            "example": "The audit system should collect access audit log directory.\\nThe following audit rule will assure that access to audit log directory are\\ncollected.\\n-a always,exit -F dir=/var/log/audit/ -F perm=r -F auid>=1000-F auid!=unset -F key=access-audit-trail\\nIf theis configured to use the augenrules\\nprogram to read audit rules during daemon startup (the default), add the\\nrule to a file with suffix .rules in the directory\\n/etc/audit/rules.d.\\nIf the auditd daemon is to use the auditctl\\nutility to read audit rules during daemon startup, add the rule to\\n/etc/audit/audit.rules file."
          },
          "rationale": {
            "type": "string",
            "example": "Attempts to read the logs should be recorded, suspicious access to audit log files could be an indicator of malicious activity on a system.\\nAuditing these events could serve as evidence of potential system compromise."
          }
        }
      },
      "rule_relationships": {
        "type": "object",
        "properties": {
          "benchmark": {
            "$ref": "#/components/schemas/relationship"
          },
          "rule_identifier": {
            "$ref": "#/components/schemas/relationship"
          },
          "profiles": {
            "$ref": "#/components/schemas/relationship_collection"
          }
        }
      },
      "status": {
        "type": "object",
        "properties": {
          "data": {
            "api": {
              "type": "boolean",
              "example": true
            }
          }
        }
      },
      "supported_ssg": {
        "type": "object",
        "required": [
          "package",
          "version"
        ],
        "properties": {
          "package": {
            "type": "string",
            "example": "scap-security-guide-0.1.30-5.el7_3"
          },
          "version": {
            "type": "string",
            "example": "0.1.30"
          },
          "os_major_version": {
            "type": "string",
            "example": "7"
          },
          "os_minor_version": {
            "type": "string",
            "example": "3"
          },
          "profiles": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      }
    }
  }
}