"""
A Business Objective registered in Insights Compliance
"""
type BusinessObjective {
  id: ID!
  title: String!
}

"""
The mutation root of this schema
"""
type Mutation {
  updateProfile(input: UpdateProfileInput!): UpdateProfilePayload
}

"""
A Profile registered in Insights Compliance
"""
type Profile {
  businessObjective: BusinessObjective
  businessObjectiveId: ID
  complianceThreshold: Float!
  compliant(
    """
    Is a system compliant?
    """
    systemId: String!
  ): Boolean!
  compliantHostCount: Int!
  description: String
  hosts: [System!]
  id: ID!
  lastScanned(
    """
    Last time this profile was scanned for a system
    """
    systemId: String!
  ): String!
  name: String!
  refId: String!
  rules: [Rule!]
  rulesFailed(
    """
    Rules failed for a system and a profile
    """
    systemId: String!
  ): Int!
  rulesPassed(
    """
    Rules passed for a system and a profile
    """
    systemId: String!
  ): Int!
  totalHostCount: Int!
}

"""
The root of all queries
"""
type Query {
  """
  All image streams visible by the user
  """
  allImageStreams(
    """
    Search query
    """
    search: String
  ): [System!]

  """
  All profiles visible by the user
  """
  allProfiles: [Profile!]

  """
  All systems visible by the user
  """
  allSystems(
    """
    Per page
    """
    page: Int

    """
    Page
    """
    perPage: Int

    """
    Profile Id
    """
    profileId: String

    """
    Search query
    """
    search: String
  ): [System!]

  """
  All business objectives visible by the user
  """
  businessObjectives: [BusinessObjective!]
  profile(id: String!): Profile

  """
  Details for a system
  """
  system(id: String!): System
}

"""
A Rule registered in Insights Compliance
"""
type Rule {
  compliant(
    """
    Is a system compliant?
    """
    systemId: String!
  ): Boolean!
  description: String
  id: ID!
  profiles: [Profile!]
  rationale: String
  refId: String!
  severity: String!
  title: String!
}

"""
A System registered in Insights Compliance
"""
type System {
  compliant(
    """
    Filter results by profile ID
    """
    profileId: String
  ): Boolean!
  id: ID!
  lastScanned(
    """
    Filter results by profile ID
    """
    profileId: String
  ): String
  name: String!
  profileNames: String!
  profiles: [Profile!]

  """
  Rules failed by a system
  """
  ruleObjectsFailed: [Rule!]
  rulesFailed(
    """
    Filter results by profile ID
    """
    profileId: String
  ): Int!
  rulesPassed(
    """
    Filter results by profile ID
    """
    profileId: String
  ): Int!
}

"""
Autogenerated input type of UpdateProfile
"""
input UpdateProfileInput {
  businessObjectiveId: ID

  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  complianceThreshold: Float
  id: ID!
}

"""
Autogenerated return type of UpdateProfile
"""
type UpdateProfilePayload {
  """
  A unique identifier for the client performing the mutation.
  """
  clientMutationId: String
  profile: Profile
}